"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),N=require("../../node_modules/chinese-lunar-calendar/src/lunar_calendar.cjs"),f=require("./const.cjs"),V=require("../checkbox/index.cjs"),C=require("../../utils/utils.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");require("../../node_modules/culori/src/index.cjs");const S=require("../../hooks/use_locale.cjs"),$=require("../../node_modules/element-plus/es/components/calendar/index.cjs"),D=require("../../node_modules/ksw-vue-icon/es/icons/base/arrow-left.cjs"),E=require("../../node_modules/ksw-vue-icon/es/icons/base/right.cjs"),w={class:"k-calendar__header"},q={class:"k-calendar__header-left"},B={class:"k-calendar__header-right"},L={class:"k-calendar__item"},b={class:"k-calendar__date"},x={class:"k-calendar__solar"},M={class:"k-calendar__schedule"},z=e.defineComponent({name:"KCalendar",__name:"calendar",props:{schedule:{default:()=>[]},showLunar:{type:Boolean,default:!1},adaptive:{type:Boolean,default:!1}},setup(h,{expose:m}){const{t:u}=S.useLocale(),_=h,c=e.ref(),s=e.ref(!1),p=e.computed(()=>function(t){const a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),o=N.lunar_calendar.getLunar(a,r,n);return{...o,lunarMonth_zh:f.lunarMonth[o.lunarMonth],lunarDate_zh:f.lunarDay[o.lunarDate]}}),k=e.computed(()=>_.schedule.map(t=>{const{date:a}=t;let r;const n=new Date(a);return n instanceof Date&&!Number.isNaN(n==null?void 0:n.getTime())&&(r=i(n)),{date:r,content:t.content}}).filter(t=>t.date)),v=e.computed(()=>function(t){const a=k.value.find(r=>r.date===i(t));return(a==null?void 0:a.content)||[]});function d(t){var a;(a=c.value)==null||a.selectDate(t)}function g(t){s.value=t}function i(t){const a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate();return`${a}-${r<10?"0":""}${r}-${n<10?"0":""}${n}`}const y={jumpDate:d,handleLunar:g};return m(C.getExposeProxy(y,c)),(t,a)=>{const r=e.resolveComponent("k-button");return e.openBlock(),e.createBlock(e.unref($.ElCalendar),e.mergeProps({ref_key:"kCalendarRef",ref:c,class:["k-calendar",{"k-calendar--adaptive":t.adaptive},"text-base"]},t.$attrs),{header:e.withCtx(({date:n})=>[e.renderSlot(t.$slots,"header",{date:n},()=>{var o;return[e.createElementVNode("div",w,[e.createElementVNode("div",q,[e.createVNode(r,{onClick:a[0]||(a[0]=l=>d("today"))},{default:e.withCtx(()=>{var l;return[e.createTextVNode(e.toDisplayString((l=e.unref(u))==null?void 0:l("calendar.today")),1)]}),_:1}),e.createVNode(r,{onClick:a[1]||(a[1]=l=>d("prev-month"))},{default:e.withCtx(()=>[e.createVNode(e.unref(D.default))]),_:1}),e.createVNode(r,{onClick:a[2]||(a[2]=l=>d("next-month"))},{default:e.withCtx(()=>[e.createVNode(e.unref(E.default))]),_:1}),e.createElementVNode("span",null,e.toDisplayString(n),1)]),e.createElementVNode("div",B,[e.renderSlot(t.$slots,"header-right"),t.showLunar?(e.openBlock(),e.createBlock(e.unref(V.KCheckbox),{key:0,modelValue:s.value,"onUpdate:modelValue":a[3]||(a[3]=l=>s.value=l),style:e.normalizeStyle({marginLeft:t.$slots["header-right"]?"8px":0}),class:"k-calendar__lunar-switch",label:(o=e.unref(u))==null?void 0:o("calendar.showLunar")},null,8,["modelValue","style","label"])):e.createCommentVNode("",!0)])])]})]),"date-cell":e.withCtx(n=>[e.renderSlot(t.$slots,"date-cell",e.normalizeProps(e.guardReactiveProps(n)),()=>[e.createElementVNode("div",L,[e.createElementVNode("div",b,[e.createElementVNode("span",x,e.toDisplayString(n.data.date.getDate()),1),e.withDirectives(e.createElementVNode("span",{class:"k-calendar__lunar"},e.toDisplayString(p.value(n.data.date).lunarDate_zh),513),[[e.vShow,s.value]])]),e.renderSlot(t.$slots,"schedule",{date:n.data.date},()=>[e.createElementVNode("div",M,[e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value(n.data.date),o=>(e.openBlock(),e.createElementBlock("li",{key:o,ref_for:!0,ref:"scheduleItemRef",class:"k-calendar__schedule-item"},e.toDisplayString(o),1))),128))])])])])])]),_:3},16,["class"])}}});exports.default=z;
