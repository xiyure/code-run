"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});require("../../node_modules/vue/dist/vue.runtime.esm-bundler.cjs");const C=require("../../node_modules/chinese-lunar-calendar/src/lunar_calendar.cjs"),f=require("./const.cjs"),q=require("../checkbox/index.cjs"),S=require("../../utils/utils.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");require("../../node_modules/culori/src/index.cjs");const D=require("../../hooks/use_locale.cjs"),$=require("../../node_modules/ksw-vue-icon/es/icons/base/arrow-left.cjs"),B=require("../../node_modules/ksw-vue-icon/es/icons/base/right.cjs"),E=require("../../node_modules/element-plus/es/components/calendar/index.cjs"),e=require("../../node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.cjs"),l=require("../../node_modules/@vue/reactivity/dist/reactivity.esm-bundler.cjs"),d=require("../../node_modules/@vue/runtime-core/node_modules/@vue/shared/dist/shared.esm-bundler.cjs"),w=require("../../node_modules/@vue/runtime-dom/dist/runtime-dom.esm-bundler.cjs"),L={class:"k-calendar__header"},b={class:"k-calendar__header-left"},x={class:"k-calendar__header-right"},M={class:"k-calendar__item"},z={class:"k-calendar__date"},P={class:"k-calendar__solar"},R={class:"k-calendar__schedule"},F=e.defineComponent({name:"KCalendar",__name:"calendar",props:{schedule:{default:()=>[]},showLunar:{type:Boolean,default:!1},adaptive:{type:Boolean,default:!1}},setup(h,{expose:p}){const{t:m}=D.useLocale(),k=h,i=l.ref(),u=l.ref(!1),v=e.computed(()=>function(t){const n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=C.lunar_calendar.getLunar(n,a,r);return{...o,lunarMonth_zh:f.lunarMonth[o.lunarMonth],lunarDate_zh:f.lunarDay[o.lunarDate]}}),g=e.computed(()=>k.schedule.map(t=>{const{date:n}=t;let a;const r=new Date(n);return r instanceof Date&&!Number.isNaN(r==null?void 0:r.getTime())&&(a=_(r)),{date:a,content:t.content}}).filter(t=>t.date)),y=e.computed(()=>function(t){const n=g.value.find(a=>a.date===_(t));return(n==null?void 0:n.content)||[]});function c(t){var n;(n=i.value)==null||n.selectDate(t)}function N(t){u.value=t}function _(t){const n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate();return`${n}-${a<10?"0":""}${a}-${r<10?"0":""}${r}`}const V={jumpDate:c,handleLunar:N};return p(S.getExposeProxy(V,i)),(t,n)=>{const a=e.resolveComponent("k-button");return e.openBlock(),e.createBlock(l.unref(E.ElCalendar),e.mergeProps({ref_key:"kCalendarRef",ref:i,class:["k-calendar",{"k-calendar--adaptive":t.adaptive},"text-base"]},t.$attrs),{header:e.withCtx(({date:r})=>[e.renderSlot(t.$slots,"header",{date:r},()=>{var o;return[e.createElementVNode("div",L,[e.createElementVNode("div",b,[e.createVNode(a,{onClick:n[0]||(n[0]=s=>c("today"))},{default:e.withCtx(()=>{var s;return[e.createTextVNode(d.toDisplayString((s=l.unref(m))==null?void 0:s("calendar.today")),1)]}),_:1}),e.createVNode(a,{onClick:n[1]||(n[1]=s=>c("prev-month"))},{default:e.withCtx(()=>[e.createVNode(l.unref($.default))]),_:1}),e.createVNode(a,{onClick:n[2]||(n[2]=s=>c("next-month"))},{default:e.withCtx(()=>[e.createVNode(l.unref(B.default))]),_:1}),e.createElementVNode("span",null,d.toDisplayString(r),1)]),e.createElementVNode("div",x,[e.renderSlot(t.$slots,"header-right"),t.showLunar?(e.openBlock(),e.createBlock(l.unref(q.KCheckbox),{key:0,modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=s=>u.value=s),style:d.normalizeStyle({marginLeft:t.$slots["header-right"]?"8px":0}),class:"k-calendar__lunar-switch",label:(o=l.unref(m))==null?void 0:o("calendar.showLunar")},null,8,["modelValue","style","label"])):e.createCommentVNode("",!0)])])]})]),"date-cell":e.withCtx(r=>[e.renderSlot(t.$slots,"date-cell",d.normalizeProps(e.guardReactiveProps(r)),()=>[e.createElementVNode("div",M,[e.createElementVNode("div",z,[e.createElementVNode("span",P,d.toDisplayString(r.data.date.getDate()),1),e.withDirectives(e.createElementVNode("span",{class:"k-calendar__lunar"},d.toDisplayString(v.value(r.data.date).lunarDate_zh),513),[[w.vShow,u.value]])]),e.renderSlot(t.$slots,"schedule",{date:r.data.date},()=>[e.createElementVNode("div",R,[e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value(r.data.date),o=>(e.openBlock(),e.createElementBlock("li",{key:o,ref_for:!0,ref:"scheduleItemRef",class:"k-calendar__schedule-item"},d.toDisplayString(o),1))),128))])])])])])]),_:3},16,["class"])}}});exports.default=F;
