"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});require("../../node_modules/vue/dist/vue.runtime.esm-bundler.cjs");const E=require("./dropdown_menu.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");const f=require("../../utils/props.cjs");require("../../node_modules/culori/src/index.cjs");const k=require("../../utils/dom.cjs"),B=require("../../hooks/use_size.cjs"),t=require("../../node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.cjs"),u=require("../../node_modules/@vue/reactivity/dist/reactivity.esm-bundler.cjs"),_=require("../../node_modules/@vue/runtime-core/node_modules/@vue/shared/dist/shared.esm-bundler.cjs"),S={class:"k-button-more-trigger"},w=t.defineComponent({name:"KButtonContainer",__name:"button_container",props:{trigger:{default:"click"},maxHeight:{default:300},placement:{default:"bottom"},hideOnClick:{type:Boolean,default:!0},showTimeout:{},hideTimeout:{},popperClass:{},teleported:{type:Boolean,default:!0},triggerIcon:{default:"IconMore"},size:{}},setup(C){const r=t.inject("__elementObserver"),g=C,a=t.useSlots(),c=u.ref(),l=u.ref(),d=u.ref([]);t.onMounted(()=>{r.observe(l.value,v)}),t.onBeforeUnmount(()=>{var e;l.value&&((e=r==null?void 0:r.unobserve)==null||e.call(r,l.value))});const p=t.computed(()=>{var e;return y(f.flattenChildren((e=a.default)==null?void 0:e.call(a)))}),h=B.useSize(g);t.watch(()=>h.value,()=>{setTimeout(()=>{v()},100)},{deep:!0});function y(e){return e.map(o=>{if(f.isValidElement(o)){const n={...o.props||{}};for(const[i,m]of Object.entries(n))delete n[i],n[f.camelize(i)]=m;return{label:(o.children||{}).default,disabled:!!n.disabled}}return null}).filter(o=>o!==null)}function v(){var n;const e=[];if(!p.value.length)return[];const o=c.value.getBoundingClientRect();(n=b())==null||n.forEach((s,i)=>{const m=s.getBoundingClientRect();!k.isElementInContainerView(m,o)&&p.value[i]?(s.style.opacity="0",e.push({...p.value[i],index:i})):s.style.opacity="1"}),d.value=e}function q(e){var n;const o=(n=b())==null?void 0:n[e];o&&o.click()}function b(){return k.getElementAll(".k-button",c.value)??[]}return t.provide(B.SIZE_KEY,h),(e,o)=>(t.openBlock(),t.createElementBlock("div",{ref_key:"box",ref:l,class:"k-button-container"},[t.createElementVNode("div",{ref_key:"container",ref:c,class:"container"},[t.renderSlot(e.$slots,"default")],512),t.createElementVNode("div",{class:"k-button-more",style:_.normalizeStyle({opacity:d.value.length>0?1:0})},[t.createVNode(u.unref(E.default),t.mergeProps({tabs:d.value,trigger:e.trigger,"max-height":e.maxHeight,placement:e.placement,"hide-on-click":e.hideOnClick,teleported:e.teleported,"show-timeout":e.showTimeout,"hide-timeout":e.hideTimeout,"popper-class":e.popperClass},e.$attrs,{onCommand:q}),{title:t.withCtx(()=>[t.createElementVNode("span",S,[t.renderSlot(e.$slots,"trigger",{},()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(g.triggerIcon)))])])]),_:3},16,["tabs","trigger","max-height","placement","hide-on-click","teleported","show-timeout","hide-timeout","popper-class"])],4)],512))}});exports.default=w;
