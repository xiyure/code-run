"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),E=require("./dropdown_menu.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");const m=require("../../utils/props.cjs");require("../../node_modules/culori/src/index.cjs");const b=require("../../utils/dom.cjs"),k=require("../../hooks/use_size.cjs"),S={class:"k-button-more-trigger"},q=e.defineComponent({name:"KButtonContainer",__name:"button_container",props:{trigger:{default:"click"},maxHeight:{default:300},placement:{default:"bottom"},hideOnClick:{type:Boolean,default:!0},showTimeout:{},hideTimeout:{},popperClass:{},teleported:{type:Boolean,default:!0},triggerIcon:{default:"IconMore"},size:{}},setup(B){const r=e.inject("__elementObserver"),f=B,a=e.useSlots(),u=e.ref(),i=e.ref(),c=e.ref([]);e.onMounted(()=>{r.observe(i.value,h)}),e.onBeforeUnmount(()=>{var t;i.value&&((t=r==null?void 0:r.unobserve)==null||t.call(r,i.value))});const d=e.computed(()=>{var t;return C(m.flattenChildren((t=a.default)==null?void 0:t.call(a)))}),g=k.useSize(f);e.watch(()=>g.value,()=>{setTimeout(()=>{h()},100)},{deep:!0});function C(t){return t.map(o=>{if(m.isValidElement(o)){const n={...o.props||{}};for(const[l,p]of Object.entries(n))delete n[l],n[m.camelize(l)]=p;return{label:(o.children||{}).default,disabled:!!n.disabled}}return null}).filter(o=>o!==null)}function h(){var n;const t=[];if(!d.value.length)return[];const o=u.value.getBoundingClientRect();(n=v())==null||n.forEach((s,l)=>{const p=s.getBoundingClientRect();!b.isElementInContainerView(p,o)&&d.value[l]?(s.style.opacity="0",t.push({...d.value[l],index:l})):s.style.opacity="1"}),c.value=t}function y(t){var n;const o=(n=v())==null?void 0:n[t];o&&o.click()}function v(){return b.getElementAll(".k-button",u.value)??[]}return e.provide(k.SIZE_KEY,g),(t,o)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"box",ref:i,class:"k-button-container"},[e.createElementVNode("div",{ref_key:"container",ref:u,class:"container"},[e.renderSlot(t.$slots,"default")],512),e.createElementVNode("div",{class:"k-button-more",style:e.normalizeStyle({opacity:c.value.length>0?1:0})},[e.createVNode(e.unref(E.default),e.mergeProps({tabs:c.value,trigger:t.trigger,"max-height":t.maxHeight,placement:t.placement,"hide-on-click":t.hideOnClick,teleported:t.teleported,"show-timeout":t.showTimeout,"hide-timeout":t.hideTimeout,"popper-class":t.popperClass},t.$attrs,{onCommand:y}),{title:e.withCtx(()=>[e.createElementVNode("span",S,[e.renderSlot(t.$slots,"trigger",{},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(f.triggerIcon)))])])]),_:3},16,["tabs","trigger","max-height","placement","hide-on-click","teleported","show-timeout","hide-timeout","popper-class"])],4)],512))}});exports.default=q;
