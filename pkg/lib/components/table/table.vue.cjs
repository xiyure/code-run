"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});require("../../node_modules/vue/dist/vue.runtime.esm-bundler.cjs");require("../../node_modules/vxe-table/es/components.cjs");const m=require("../../node_modules/dom-zindex/es/index.esm.cjs"),d=require("../../utils/utils.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");require("../../node_modules/culori/src/index.cjs");const n=require("./const.cjs"),M=require("../../node_modules/vxe-table/es/table/index.cjs"),t=require("../../node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.cjs"),_=require("../../node_modules/@vue/reactivity/dist/reactivity.esm-bundler.cjs"),w=require("../../node_modules/@vue/runtime-core/node_modules/@vue/shared/dist/shared.esm-bundler.cjs"),B=t.defineComponent({name:"KTable",__name:"table",props:{showColumnMenu:{type:Boolean},sortConfig:{},filterConfig:{}},emits:["desc-change","hide-column","sort-change","clear-sort","filter-change","filter-visible","clear-filter"],setup(E,{expose:C,emit:g}){const c={descChange:{name:n.DESC_CHANGE,callback:L.bind(this)},hideColumn:{name:n.HIDE_COLUMN,callback:T.bind(this)},clearFilter:{name:n.CLEAR_FILTER,callback:q.bind(this)},filterChange:{name:n.FILTER_CHANGE,callback:A.bind(this)},filterVisible:{name:n.FILTER_VISIBLE,callback:O.bind(this)},sortChange:{name:n.SORT_CHANGE,callback:N.bind(this)},clearSort:{name:n.CLEAR_SORT,callback:k.bind(this)}},s=E,p=t.computed(()=>{const{chronological:e,multiple:r}=s.sortConfig??{};return{chronological:e,multiple:r,remote:!0}}),b=t.computed(()=>({remote:!0})),i=d.genRandomStr(8),o=t.inject("_emitter");for(const e in c){const{name:r,callback:a}=c[e];o.on(r,i,a)}const l=g;t.onMounted(()=>{h()});const u=_.ref();t.onUnmounted(()=>{for(const e in c){const{name:r}=c[e];o.remove(r,i)}});function h(){const e=m.default.getMax();m.default.setCurrent(e+1)}function L(e,r){l(n.DESC_CHANGE,e,r)}function T(e){l(n.HIDE_COLUMN,e)}function F(e,r=[]){return new Promise(a=>{o.emit(n.SET_FILTER,i,e,r),a(!0)})}function R(e){return new Promise(r=>{o.emit(n.CLEAR_FILTER_OUTSIDE,i,e),r(!0)})}function I(e){return new Promise(r=>{o.emit(n.OPEN_FILTER_PANEL,i,e),r(!0)})}function S(){return new Promise(e=>{o.emit(n.RESET_FILTER_PANEL,i),e(!0)})}function v(){return new Promise(e=>{o.emit(n.SAVE_FILTER_PANEL,i),e(!0)})}function P(){return new Promise(e=>{o.emit(n.CLOSE_FILTER_PANEL,i),e(!0)})}function N(e){l("sort-change",e)}function k(e){l("clear-sort",e)}function A(e){l("filter-change",e)}function O(e){l("filter-visible",e)}function q(e){l("clear-filter",e)}return t.provide(n.TABLE_KEY,u),t.provide(n.TABLE_ID,i),t.provide(n.SORT_CONFIG_KEY,t.computed(()=>s.sortConfig)),t.provide(n.FILTER_CONFIG_KEY,t.computed(()=>s.filterConfig??{})),t.provide(n.SHOW_COLUMN_MENU_KEY,s.showColumnMenu),C(d.getExposeProxy({setFilter:F,clearFilter:R,openFilter:I,closeFilter:P,resetFilterPanel:S,saveFilterPanel:v},u)),(e,r)=>(t.openBlock(),t.createBlock(_.unref(M.VxeTable),t.mergeProps({ref_key:"vxeTableRef",ref:u,class:"k-table","sort-config":p.value,"filter-config":b.value},e.$attrs),t.createSlots({_:2},[t.renderList(e.$slots,(a,f)=>({name:f,fn:t.withCtx(x=>[t.renderSlot(e.$slots,f,w.normalizeProps(t.guardReactiveProps(x)))])}))]),1040,["sort-config","filter-config"]))}});exports.default=B;
