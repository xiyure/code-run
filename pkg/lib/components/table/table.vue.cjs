"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue");require("../../node_modules/vxe-table/es/components.cjs");const m=require("../../node_modules/dom-zindex/es/index.esm.cjs"),E=require("../../utils/utils.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");require("../../node_modules/culori/src/index.cjs");const n=require("./const.cjs"),M=require("../../node_modules/vxe-table/es/table/index.cjs"),q=t.defineComponent({name:"KTable",__name:"table",props:{showColumnMenu:{type:Boolean},sortConfig:{},filterConfig:{}},emits:["desc-change","hide-column","sort-change","clear-sort","filter-change","filter-visible","clear-filter"],setup(d,{expose:_,emit:C}){const c={descChange:{name:n.DESC_CHANGE,callback:L.bind(this)},hideColumn:{name:n.HIDE_COLUMN,callback:h.bind(this)},clearFilter:{name:n.CLEAR_FILTER,callback:O.bind(this)},filterChange:{name:n.FILTER_CHANGE,callback:k.bind(this)},filterVisible:{name:n.FILTER_VISIBLE,callback:A.bind(this)},sortChange:{name:n.SORT_CHANGE,callback:P.bind(this)},clearSort:{name:n.CLEAR_SORT,callback:N.bind(this)}},s=d,g=t.computed(()=>{const{chronological:e,multiple:r}=s.sortConfig??{};return{chronological:e,multiple:r,remote:!0}}),p=t.computed(()=>({remote:!0})),o=E.genRandomStr(8),i=t.inject("_emitter");for(const e in c){const{name:r,callback:a}=c[e];i.on(r,o,a)}const l=C;t.onMounted(()=>{b()});const u=t.ref();t.onUnmounted(()=>{for(const e in c){const{name:r}=c[e];i.remove(r,o)}});function b(){const e=m.default.getMax();m.default.setCurrent(e+1)}function L(e,r){l(n.DESC_CHANGE,e,r)}function h(e){l(n.HIDE_COLUMN,e)}function T(e,r=[]){return new Promise(a=>{i.emit(n.SET_FILTER,o,e,r),a(!0)})}function F(e){return new Promise(r=>{i.emit(n.CLEAR_FILTER_OUTSIDE,o,e),r(!0)})}function R(e){return new Promise(r=>{i.emit(n.OPEN_FILTER_PANEL,o,e),r(!0)})}function I(){return new Promise(e=>{i.emit(n.RESET_FILTER_PANEL,o),e(!0)})}function S(){return new Promise(e=>{i.emit(n.SAVE_FILTER_PANEL,o),e(!0)})}function v(){return new Promise(e=>{i.emit(n.CLOSE_FILTER_PANEL,o),e(!0)})}function P(e){l("sort-change",e)}function N(e){l("clear-sort",e)}function k(e){l("filter-change",e)}function A(e){l("filter-visible",e)}function O(e){l("clear-filter",e)}return t.provide(n.TABLE_KEY,u),t.provide(n.TABLE_ID,o),t.provide(n.SORT_CONFIG_KEY,t.computed(()=>s.sortConfig)),t.provide(n.FILTER_CONFIG_KEY,t.computed(()=>s.filterConfig??{})),t.provide(n.SHOW_COLUMN_MENU_KEY,s.showColumnMenu),_(E.getExposeProxy({setFilter:T,clearFilter:F,openFilter:R,closeFilter:v,resetFilterPanel:I,saveFilterPanel:S},u)),(e,r)=>(t.openBlock(),t.createBlock(t.unref(M.VxeTable),t.mergeProps({ref_key:"vxeTableRef",ref:u,class:"k-table","sort-config":g.value,"filter-config":p.value},e.$attrs),t.createSlots({_:2},[t.renderList(e.$slots,(a,f)=>({name:f,fn:t.withCtx(x=>[t.renderSlot(e.$slots,f,t.normalizeProps(t.guardReactiveProps(x)))])}))]),1040,["sort-config","filter-config"]))}});exports.default=q;
