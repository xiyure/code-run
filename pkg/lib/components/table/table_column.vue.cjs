"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});require("../../node_modules/vue/dist/vue.runtime.esm-bundler.cjs");require("../../node_modules/vxe-table/es/components.cjs");const O=require("./filter_popper.vue.cjs"),I=require("../popover/index.cjs"),le=require("../dialog/index.cjs"),ne=require("../input/index.cjs"),L=require("../button/index.cjs"),re=require("../tooltip/index.cjs"),ie=require("../../hooks/use_locale.cjs"),ce=require("../../hooks/use_inherit_slot.cjs"),se=require("./hooks/use_sort.cjs"),ae=require("./hooks/use_filter.cjs"),N=require("./const.cjs"),ue=require("../../node_modules/element-plus/es/directives/click-outside/index.cjs"),de=require("../../node_modules/ksw-vue-icon/es/icons/base/table-sort-up-color.cjs"),fe=require("../../node_modules/ksw-vue-icon/es/icons/base/clearDate.cjs"),me=require("../../node_modules/ksw-vue-icon/es/icons/base/Edit.cjs"),pe=require("../../node_modules/ksw-vue-icon/es/icons/base/ellipsis-horizontal.cjs"),ke=require("../../node_modules/ksw-vue-icon/es/icons/base/eye-off.cjs"),Ce=require("../../node_modules/ksw-vue-icon/es/icons/base/filter-fill.cjs"),j=require("../../node_modules/ksw-vue-icon/es/icons/base/filter.cjs"),_e=require("../../node_modules/ksw-vue-icon/es/icons/base/fold.cjs"),ve=require("../../node_modules/ksw-vue-icon/es/icons/base/right.cjs"),ye=require("../../node_modules/ksw-vue-icon/es/icons/base/table-sort-down-color.cjs"),Ve=require("../../node_modules/ksw-vue-icon/es/icons/base/table-sort-normal-color.cjs"),Ne=require("../../node_modules/ksw-vue-icon/es/icons/base/tips.cjs"),be=require("../../node_modules/ksw-vue-icon/es/icons/base/unfold.cjs"),Be=require("../../node_modules/vxe-table/es/column/index.cjs"),e=require("../../node_modules/@vue/runtime-core/dist/runtime-core.esm-bundler.cjs"),t=require("../../node_modules/@vue/reactivity/dist/reactivity.esm-bundler.cjs"),i=require("../../node_modules/@vue/runtime-core/node_modules/@vue/shared/dist/shared.esm-bundler.cjs"),he=["onClick"],ge={class:"k-table-column__title"},Ee={key:0,class:"k-table-column__edit vxe-table-icon-edit"},we={class:"k-column__header-dialog"},xe={class:"header-dialog__buttons"},Fe={class:"k-table-column__operate"},qe={key:0,class:"k-table-column__tooltip"},De=["onClick"],Se=["onClick"],$e={key:2,class:"k-table-column__more"},Te={class:"more-menu"},ze={class:"more-menu-item"},Me={class:"more-menu-item"},Re={class:"sort-menu"},Ke=["onClick"],Oe=["onClick"],Ie=["onClick"],Le=["onClick"],je={key:1},Ue=e.createElementVNode("span",null,"-",-1),Ae=e.defineComponent({name:"KTableColumn",__name:"table_column",props:{sortable:{type:Boolean},filters:{},desc:{},showColumnMenu:{type:Boolean,default:void 0},editRender:{},type:{},field:{},filterMultiple:{type:Boolean,default:!0}},setup(U){const{t:c}=ie.useLocale(),A=ce.useInheritSlot(["default"]),m=e.inject(N.TABLE_KEY,e.computed(()=>null)),H=e.inject("__showTransfer",e.computed(()=>!1)),F=e.inject(N.TABLE_ID),W=e.inject(N.SHOW_COLUMN_MENU_KEY,!1),s=U,E=t.ref(),w=t.ref(),b=t.ref(!1),q=t.ref(""),p=t.ref(""),k=t.ref(!1),B=t.ref(""),u=e.inject("_emitter"),D=e.computed(()=>s.showColumnMenu??W),{sortConfig:C,showSortIcon:Y,allowButtonSort:G,changeSortStatus:h,tableSort:S,tableSortByHeader:J,clearSort:Q}=se.useSort(m,s,u),{isFilter:x,filterConfig:d,showFilterIcon:X,filterButtonText:$,filterPanelVisible:g,setFilter:T,clearFilter:z,filterVisible:M,onCloseFilterPanel:Z}=ae.useFilter(m,s,u,w);e.watch(()=>s.desc,o=>{o&&(p.value=o)},{immediate:!0});function P(o){const r=w.value.popperRef;(!E.value||!r.contains(o.target))&&(g.value=!1)}function R(o){var n,f;b.value=o;let r="";o?(q.value=(n=m.value)==null?void 0:n.getColumnWidth(s.field??""),r="40"):r=q.value??"",(f=m.value)==null||f.setColumnWidth(s.field??"",r)}function ee(){B.value=p.value??""}function te(o){p.value=B.value,k.value=!1,u==null||u.emit(N.DESC_CHANGE,F,o,p.value)}function oe(o){var r;u==null||u.emit(N.HIDE_COLUMN,F,o),(r=E.value)==null||r.hide()}return(o,r)=>(e.openBlock(),e.createBlock(t.unref(Be.VxeColumn),e.mergeProps(o.$attrs,{"edit-render":o.editRender,filters:o.filters,sortable:o.sortable,type:o.type,field:o.field,class:"k-table-column"}),e.createSlots({_:2},[o.type?void 0:{name:"header",fn:e.withCtx(n=>{var f;return[b.value?(e.openBlock(),e.createElementBlock("div",je,[e.createVNode(t.unref(be.default),{style:{width:"20px",cursor:"pointer"},class:"expand-icon",onClick:r[6]||(r[6]=l=>R(!1))})])):(e.openBlock(),e.createElementBlock("div",{key:0,class:"k-table-column__header",onClick:l=>t.unref(J)(n.column,l)},[e.createElementVNode("div",ge,[e.renderSlot(o.$slots,"header",i.normalizeProps(e.guardReactiveProps(n)),()=>{var l,_,v;return[(l=t.unref(m))!=null&&l.editConfig&&((v=(_=t.unref(m))==null?void 0:_.editConfig)==null?void 0:v.showIcon)!==!1&&o.editRender?(e.openBlock(),e.createElementBlock("i",Ee)):e.createCommentVNode("",!0),e.createTextVNode(" "+i.toDisplayString(n.column.title??"-"),1)]})]),D.value?(e.openBlock(),e.createBlock(t.unref(le.KDialog),{key:0,modelValue:k.value,"onUpdate:modelValue":r[2]||(r[2]=l=>k.value=l),title:(f=t.unref(c))==null?void 0:f("table.remark"),onOpen:ee},{default:e.withCtx(()=>[e.createElementVNode("div",we,[e.createVNode(t.unref(ne.KInput),{modelValue:B.value,"onUpdate:modelValue":r[0]||(r[0]=l=>B.value=l),type:"textarea"},null,8,["modelValue"]),e.createElementVNode("div",xe,[e.createVNode(t.unref(L.KButton),{onClick:r[1]||(r[1]=()=>k.value=!1)},{default:e.withCtx(()=>{var l;return[e.createTextVNode(i.toDisplayString((l=t.unref(c))==null?void 0:l("table.cancel")),1)]}),_:1}),e.createVNode(t.unref(L.KButton),{main:"",onClick:l=>te(n.column)},{default:e.withCtx(()=>{var l;return[e.createTextVNode(i.toDisplayString((l=t.unref(c))==null?void 0:l("table.confirm")),1)]}),_:2},1032,["onClick"])])])]),_:2},1032,["modelValue","title"])):e.createCommentVNode("",!0),e.createElementVNode("div",Fe,[p.value?(e.openBlock(),e.createElementBlock("span",qe,[e.createVNode(t.unref(re.KTooltip),{trigger:"click",content:p.value,placement:"top"},{default:e.withCtx(()=>[e.createElementVNode("i",null,[e.createVNode(t.unref(Ne.default))])]),_:1},8,["content"])])):e.createCommentVNode("",!0),t.unref(Y)?(e.openBlock(),e.createElementBlock("span",{key:1,class:i.normalizeClass(["k-table-column__sort",t.unref(C).iconLayout==="horizontal"?"sort-icon__horizontal":"sort-icon__vertical",t.unref(G)?"":"sort-btn-disabled"])},[t.unref(C).iconAsc?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.unref(C).iconAsc),{key:0,style:i.normalizeStyle({color:n.column.order=="asc"?"#2882FF":"",fontSize:"15px"}),onClick:l=>t.unref(h)("_asc-icon",n.column,l)},null,8,["style","onClick"])):(e.openBlock(),e.createElementBlock("i",{key:1,class:"vxe-table-icon-caret-up icon-asc",style:i.normalizeStyle({color:n.column.order=="asc"?"#2882FF":""}),onClick:l=>t.unref(h)("_asc-icon",n.column,l)},null,12,De)),t.unref(C).iconDesc?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.unref(C).iconDesc),{key:2,style:i.normalizeStyle({color:n.column.order=="desc"?"#2882FF":"",fontSize:"15px"}),onClick:l=>t.unref(h)("_desc-icon",n.column,l)},null,8,["style","onClick"])):(e.openBlock(),e.createElementBlock("i",{key:3,class:"vxe-table-icon-caret-down icon-desc",style:i.normalizeStyle({color:n.column.order=="desc"?"#2882FF":""}),onClick:l=>t.unref(h)("_desc-icon",n.column,l)},null,12,Se))],2)):e.createCommentVNode("",!0),e.createVNode(O.default,{ref_key:"popperOutRef",ref:w,filters:s.filters,column:n.column,text:t.unref($),teleported:t.unref(d).transfer,visible:t.unref(g),"destroy-on-close":t.unref(d).destroyOnClose,"filter-multiple":o.filterMultiple,onSetFilter:t.unref(T),onClearFilter:t.unref(z),onFilterVisible:t.unref(M),onCloseFilterPanel:t.unref(Z)},{default:e.withCtx(()=>[e.withDirectives((e.openBlock(),e.createElementBlock("span",{class:i.normalizeClass(["k-table-column__filter",["k-table-column__filter",{"k-table-column__filter--hide-icon":!t.unref(X)}]]),onClick:r[3]||(r[3]=()=>g.value=!t.unref(g))},[t.unref(d).iconNone&&!t.unref(x)?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.unref(d).iconNone),{key:0})):t.unref(d).iconMatch&&t.unref(x)?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.unref(d).iconMatch),{key:1})):t.unref(x)?(e.openBlock(),e.createBlock(t.unref(Ce.default),{key:2,size:16,color:"#2882FF"})):(e.openBlock(),e.createBlock(t.unref(j.default),{key:3,size:16}))],2)),[[t.unref(ue.default),P]]),o.$slots.filter?e.renderSlot(o.$slots,"filter",{key:0,column:n.column}):e.createCommentVNode("",!0)]),_:2},1032,["filters","column","text","teleported","visible","destroy-on-close","filter-multiple","onSetFilter","onClearFilter","onFilterVisible","onCloseFilterPanel"]),D.value?(e.openBlock(),e.createElementBlock("span",$e,[e.createVNode(t.unref(I.KPopover),{ref_key:"popoverRef",ref:E,trigger:"click","show-arrow":!1,placement:"bottom-start","popper-class":"more-box",offset:2,width:"160px"},{reference:e.withCtx(()=>[e.createElementVNode("i",null,[e.createVNode(t.unref(pe.default))])]),default:e.withCtx(()=>{var l,_,v;return[e.createElementVNode("ul",Te,[e.createElementVNode("li",ze,[e.createVNode(O.default,{filters:s.filters,column:n.column,text:t.unref($),teleported:t.unref(d).transfer,"destroy-on-close":t.unref(d).destroyOnClose,"filter-multiple":o.filterMultiple,onSetFilter:t.unref(T),onClearFilter:t.unref(z),onFilterVisible:t.unref(M)},e.createSlots({default:e.withCtx(({disabled:a})=>{var y;return[e.createElementVNode("div",{class:i.normalizeClass(["filter-select-item",{disabled:a}])},[e.createVNode(t.unref(j.default),{class:"menu-item-icon"}),e.createTextVNode(" "+i.toDisplayString((y=t.unref(c))==null?void 0:y("table.filter")),1)],2)]}),_:2},[o.$slots.filter?{name:"filter",fn:e.withCtx(()=>[e.renderSlot(o.$slots,"filter",{column:n.column})]),key:"0"}:void 0]),1032,["filters","column","text","teleported","destroy-on-close","filter-multiple","onSetFilter","onClearFilter","onFilterVisible"])]),e.createElementVNode("li",Me,[e.createVNode(t.unref(I.KPopover),{trigger:"hover","show-arrow":!1,placement:"right-start","popper-class":"more-box",offset:2,disabled:!s.sortable,teleported:!1},{reference:e.withCtx(()=>{var a;return[e.createElementVNode("div",{class:i.normalizeClass(["sort-select-item",{disabled:!s.sortable}])},[e.createVNode(t.unref(Ve.default),{class:"menu-item-icon"}),e.createTextVNode(" "+i.toDisplayString((a=t.unref(c))==null?void 0:a("table.sort"))+" ",1),e.createVNode(t.unref(ve.default),{class:"sort-arrow-right"})],2)]}),default:e.withCtx(()=>{var a,y,K;return[e.createElementVNode("ul",Re,[e.createElementVNode("li",{class:"sort-menu-item",onClick:V=>t.unref(S)(n.column,"asc",V)},[e.createVNode(t.unref(de.default)),e.createTextVNode(" "+i.toDisplayString((a=t.unref(c))==null?void 0:a("table.asc")),1)],8,Ke),e.createElementVNode("li",{class:"sort-menu-item",onClick:V=>t.unref(S)(n.column,"desc",V)},[e.createVNode(t.unref(ye.default)),e.createTextVNode(" "+i.toDisplayString((y=t.unref(c))==null?void 0:y("table.desc")),1)],8,Oe),e.createElementVNode("li",{class:"sort-menu-item",onClick:V=>t.unref(Q)(n.column,V)},[e.createVNode(t.unref(fe.default)),e.createTextVNode(" "+i.toDisplayString((K=t.unref(c))==null?void 0:K("table.clear")),1)],8,Ie)])]}),_:2},1032,["disabled"])]),e.createElementVNode("li",{class:"more-menu-item",onClick:r[4]||(r[4]=a=>R(!0))},[e.createVNode(t.unref(_e.default),{class:"menu-item-icon"}),e.createTextVNode(" "+i.toDisplayString((l=t.unref(c))==null?void 0:l("table.retract")),1)]),t.unref(H)?(e.openBlock(),e.createElementBlock("li",{key:0,class:"more-menu-item",onClick:a=>oe(n.column)},[e.createVNode(t.unref(ke.default),{class:"menu-item-icon"}),e.createTextVNode(" "+i.toDisplayString((_=t.unref(c))==null?void 0:_("table.hide")),1)],8,Le)):e.createCommentVNode("",!0),e.createElementVNode("li",{class:"more-menu-item",onClick:r[5]||(r[5]=()=>k.value=!0)},[e.createVNode(t.unref(me.default),{class:"menu-item-icon"}),e.createTextVNode(" "+i.toDisplayString((v=t.unref(c))==null?void 0:v("table.remark")),1)])])]}),_:2},1536)])):e.createCommentVNode("",!0)])],8,he))]}),key:"0"},b.value?{name:"default",fn:e.withCtx(()=>[Ue]),key:"1"}:o.$slots.default&&!b.value?{name:"default",fn:e.withCtx(n=>[e.renderSlot(o.$slots,"default",i.normalizeProps(e.guardReactiveProps(n)))]),key:"2"}:void 0,e.renderList(t.unref(A)(o.$slots),(n,f)=>({name:f,fn:e.withCtx(l=>[e.renderSlot(o.$slots,f,i.normalizeProps(e.guardReactiveProps(l)))])}))]),1040,["edit-render","filters","sortable","type","field"]))}});exports.default=Ae;
