"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue");require("../../node_modules/vxe-table/es/components.cjs");const R=require("./filter_popper.vue.cjs"),K=require("../popover/index.cjs"),te=require("../dialog/index.cjs"),oe=require("../input/index.cjs"),O=require("../button/index.cjs"),le=require("../tooltip/index.cjs"),ne=require("../../hooks/use_locale.cjs"),re=require("../../hooks/use_inherit_slot.cjs"),ie=require("./hooks/use_sort.cjs"),ce=require("./hooks/use_filter.cjs"),V=require("./const.cjs"),se=require("../../node_modules/vxe-table/es/column/index.cjs"),ae=require("../../node_modules/element-plus/es/directives/click-outside/index.cjs"),ue=require("../../node_modules/ksw-vue-icon/es/icons/base/table-sort-up-color.cjs"),fe=require("../../node_modules/ksw-vue-icon/es/icons/base/clearDate.cjs"),de=require("../../node_modules/ksw-vue-icon/es/icons/base/Edit.cjs"),me=require("../../node_modules/ksw-vue-icon/es/icons/base/ellipsis-horizontal.cjs"),pe=require("../../node_modules/ksw-vue-icon/es/icons/base/eye-off.cjs"),ke=require("../../node_modules/ksw-vue-icon/es/icons/base/filter-fill.cjs"),I=require("../../node_modules/ksw-vue-icon/es/icons/base/filter.cjs"),Ce=require("../../node_modules/ksw-vue-icon/es/icons/base/fold.cjs"),_e=require("../../node_modules/ksw-vue-icon/es/icons/base/right.cjs"),ve=require("../../node_modules/ksw-vue-icon/es/icons/base/table-sort-down-color.cjs"),Ve=require("../../node_modules/ksw-vue-icon/es/icons/base/table-sort-normal-color.cjs"),ye=require("../../node_modules/ksw-vue-icon/es/icons/base/tips.cjs"),Ne=require("../../node_modules/ksw-vue-icon/es/icons/base/unfold.cjs"),be=["onClick"],Be={class:"k-table-column__title"},he={key:0,class:"k-table-column__edit vxe-table-icon-edit"},ge={class:"k-column__header-dialog"},Ee={class:"header-dialog__buttons"},we={class:"k-table-column__operate"},xe={key:0,class:"k-table-column__tooltip"},Fe=["onClick"],qe=["onClick"],De={key:2,class:"k-table-column__more"},Se={class:"more-menu"},$e={class:"more-menu-item"},Te={class:"more-menu-item"},ze={class:"sort-menu"},Me=["onClick"],Re=["onClick"],Ke=["onClick"],Oe=["onClick"],Ie={key:1},Le=e.createElementVNode("span",null,"-",-1),je=e.defineComponent({name:"KTableColumn",__name:"table_column",props:{sortable:{type:Boolean},filters:{},desc:{},showColumnMenu:{type:Boolean,default:void 0},editRender:{},type:{},field:{},filterMultiple:{type:Boolean,default:!0}},setup(L){const{t:r}=ne.useLocale(),j=re.useInheritSlot(["default"]),f=e.inject(V.TABLE_KEY,e.computed(()=>null)),U=e.inject("__showTransfer",e.computed(()=>!1)),w=e.inject(V.TABLE_ID),A=e.inject(V.SHOW_COLUMN_MENU_KEY,!1),i=L,h=e.ref(),g=e.ref(),y=e.ref(!1),x=e.ref(""),d=e.ref(""),m=e.ref(!1),N=e.ref(""),s=e.inject("_emitter"),F=e.computed(()=>i.showColumnMenu??A),{sortConfig:p,showSortIcon:H,allowButtonSort:W,changeSortStatus:b,tableSort:q,tableSortByHeader:Y,clearSort:G}=ie.useSort(f,i,s),{isFilter:E,filterConfig:a,showFilterIcon:J,filterButtonText:D,filterPanelVisible:B,setFilter:S,clearFilter:$,filterVisible:T,onCloseFilterPanel:Q}=ce.useFilter(f,i,s,g);e.watch(()=>i.desc,t=>{t&&(d.value=t)},{immediate:!0});function X(t){const n=g.value.popperRef;(!h.value||!n.contains(t.target))&&(B.value=!1)}function z(t){var l,u;y.value=t;let n="";t?(x.value=(l=f.value)==null?void 0:l.getColumnWidth(i.field??""),n="40"):n=x.value??"",(u=f.value)==null||u.setColumnWidth(i.field??"",n)}function Z(){N.value=d.value??""}function P(t){d.value=N.value,m.value=!1,s==null||s.emit(V.DESC_CHANGE,w,t,d.value)}function ee(t){var n;s==null||s.emit(V.HIDE_COLUMN,w,t),(n=h.value)==null||n.hide()}return(t,n)=>(e.openBlock(),e.createBlock(e.unref(se.VxeColumn),e.mergeProps(t.$attrs,{"edit-render":t.editRender,filters:t.filters,sortable:t.sortable,type:t.type,field:t.field,class:"k-table-column"}),e.createSlots({_:2},[t.type?void 0:{name:"header",fn:e.withCtx(l=>{var u;return[y.value?(e.openBlock(),e.createElementBlock("div",Ie,[e.createVNode(e.unref(Ne.default),{style:{width:"20px",cursor:"pointer"},class:"expand-icon",onClick:n[6]||(n[6]=o=>z(!1))})])):(e.openBlock(),e.createElementBlock("div",{key:0,class:"k-table-column__header",onClick:o=>e.unref(Y)(l.column,o)},[e.createElementVNode("div",Be,[e.renderSlot(t.$slots,"header",e.normalizeProps(e.guardReactiveProps(l)),()=>{var o,k,C;return[(o=e.unref(f))!=null&&o.editConfig&&((C=(k=e.unref(f))==null?void 0:k.editConfig)==null?void 0:C.showIcon)!==!1&&t.editRender?(e.openBlock(),e.createElementBlock("i",he)):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(l.column.title??"-"),1)]})]),F.value?(e.openBlock(),e.createBlock(e.unref(te.KDialog),{key:0,modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=o=>m.value=o),title:(u=e.unref(r))==null?void 0:u("table.remark"),onOpen:Z},{default:e.withCtx(()=>[e.createElementVNode("div",ge,[e.createVNode(e.unref(oe.KInput),{modelValue:N.value,"onUpdate:modelValue":n[0]||(n[0]=o=>N.value=o),type:"textarea"},null,8,["modelValue"]),e.createElementVNode("div",Ee,[e.createVNode(e.unref(O.KButton),{onClick:n[1]||(n[1]=()=>m.value=!1)},{default:e.withCtx(()=>{var o;return[e.createTextVNode(e.toDisplayString((o=e.unref(r))==null?void 0:o("table.cancel")),1)]}),_:1}),e.createVNode(e.unref(O.KButton),{main:"",onClick:o=>P(l.column)},{default:e.withCtx(()=>{var o;return[e.createTextVNode(e.toDisplayString((o=e.unref(r))==null?void 0:o("table.confirm")),1)]}),_:2},1032,["onClick"])])])]),_:2},1032,["modelValue","title"])):e.createCommentVNode("",!0),e.createElementVNode("div",we,[d.value?(e.openBlock(),e.createElementBlock("span",xe,[e.createVNode(e.unref(le.KTooltip),{trigger:"click",content:d.value,placement:"top"},{default:e.withCtx(()=>[e.createElementVNode("i",null,[e.createVNode(e.unref(ye.default))])]),_:1},8,["content"])])):e.createCommentVNode("",!0),e.unref(H)?(e.openBlock(),e.createElementBlock("span",{key:1,class:e.normalizeClass(["k-table-column__sort",e.unref(p).iconLayout==="horizontal"?"sort-icon__horizontal":"sort-icon__vertical",e.unref(W)?"":"sort-btn-disabled"])},[e.unref(p).iconAsc?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(p).iconAsc),{key:0,style:e.normalizeStyle({color:l.column.order=="asc"?"#2882FF":"",fontSize:"15px"}),onClick:o=>e.unref(b)("_asc-icon",l.column,o)},null,8,["style","onClick"])):(e.openBlock(),e.createElementBlock("i",{key:1,class:"vxe-table-icon-caret-up icon-asc",style:e.normalizeStyle({color:l.column.order=="asc"?"#2882FF":""}),onClick:o=>e.unref(b)("_asc-icon",l.column,o)},null,12,Fe)),e.unref(p).iconDesc?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(p).iconDesc),{key:2,style:e.normalizeStyle({color:l.column.order=="desc"?"#2882FF":"",fontSize:"15px"}),onClick:o=>e.unref(b)("_desc-icon",l.column,o)},null,8,["style","onClick"])):(e.openBlock(),e.createElementBlock("i",{key:3,class:"vxe-table-icon-caret-down icon-desc",style:e.normalizeStyle({color:l.column.order=="desc"?"#2882FF":""}),onClick:o=>e.unref(b)("_desc-icon",l.column,o)},null,12,qe))],2)):e.createCommentVNode("",!0),e.createVNode(R.default,{ref_key:"popperOutRef",ref:g,filters:i.filters,column:l.column,text:e.unref(D),teleported:e.unref(a).transfer,visible:e.unref(B),"destroy-on-close":e.unref(a).destroyOnClose,"filter-multiple":t.filterMultiple,onSetFilter:e.unref(S),onClearFilter:e.unref($),onFilterVisible:e.unref(T),onCloseFilterPanel:e.unref(Q)},{default:e.withCtx(()=>[e.withDirectives((e.openBlock(),e.createElementBlock("span",{class:e.normalizeClass(["k-table-column__filter",["k-table-column__filter",{"k-table-column__filter--hide-icon":!e.unref(J)}]]),onClick:n[3]||(n[3]=()=>B.value=!e.unref(B))},[e.unref(a).iconNone&&!e.unref(E)?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(a).iconNone),{key:0})):e.unref(a).iconMatch&&e.unref(E)?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(a).iconMatch),{key:1})):e.unref(E)?(e.openBlock(),e.createBlock(e.unref(ke.default),{key:2,size:16,color:"#2882FF"})):(e.openBlock(),e.createBlock(e.unref(I.default),{key:3,size:16}))],2)),[[e.unref(ae.default),X]]),t.$slots.filter?e.renderSlot(t.$slots,"filter",{key:0,column:l.column}):e.createCommentVNode("",!0)]),_:2},1032,["filters","column","text","teleported","visible","destroy-on-close","filter-multiple","onSetFilter","onClearFilter","onFilterVisible","onCloseFilterPanel"]),F.value?(e.openBlock(),e.createElementBlock("span",De,[e.createVNode(e.unref(K.KPopover),{ref_key:"popoverRef",ref:h,trigger:"click","show-arrow":!1,placement:"bottom-start","popper-class":"more-box",offset:2,width:"160px"},{reference:e.withCtx(()=>[e.createElementVNode("i",null,[e.createVNode(e.unref(me.default))])]),default:e.withCtx(()=>{var o,k,C;return[e.createElementVNode("ul",Se,[e.createElementVNode("li",$e,[e.createVNode(R.default,{filters:i.filters,column:l.column,text:e.unref(D),teleported:e.unref(a).transfer,"destroy-on-close":e.unref(a).destroyOnClose,"filter-multiple":t.filterMultiple,onSetFilter:e.unref(S),onClearFilter:e.unref($),onFilterVisible:e.unref(T)},e.createSlots({default:e.withCtx(({disabled:c})=>{var _;return[e.createElementVNode("div",{class:e.normalizeClass(["filter-select-item",{disabled:c}])},[e.createVNode(e.unref(I.default),{class:"menu-item-icon"}),e.createTextVNode(" "+e.toDisplayString((_=e.unref(r))==null?void 0:_("table.filter")),1)],2)]}),_:2},[t.$slots.filter?{name:"filter",fn:e.withCtx(()=>[e.renderSlot(t.$slots,"filter",{column:l.column})]),key:"0"}:void 0]),1032,["filters","column","text","teleported","destroy-on-close","filter-multiple","onSetFilter","onClearFilter","onFilterVisible"])]),e.createElementVNode("li",Te,[e.createVNode(e.unref(K.KPopover),{trigger:"hover","show-arrow":!1,placement:"right-start","popper-class":"more-box",offset:2,disabled:!i.sortable,teleported:!1},{reference:e.withCtx(()=>{var c;return[e.createElementVNode("div",{class:e.normalizeClass(["sort-select-item",{disabled:!i.sortable}])},[e.createVNode(e.unref(Ve.default),{class:"menu-item-icon"}),e.createTextVNode(" "+e.toDisplayString((c=e.unref(r))==null?void 0:c("table.sort"))+" ",1),e.createVNode(e.unref(_e.default),{class:"sort-arrow-right"})],2)]}),default:e.withCtx(()=>{var c,_,M;return[e.createElementVNode("ul",ze,[e.createElementVNode("li",{class:"sort-menu-item",onClick:v=>e.unref(q)(l.column,"asc",v)},[e.createVNode(e.unref(ue.default)),e.createTextVNode(" "+e.toDisplayString((c=e.unref(r))==null?void 0:c("table.asc")),1)],8,Me),e.createElementVNode("li",{class:"sort-menu-item",onClick:v=>e.unref(q)(l.column,"desc",v)},[e.createVNode(e.unref(ve.default)),e.createTextVNode(" "+e.toDisplayString((_=e.unref(r))==null?void 0:_("table.desc")),1)],8,Re),e.createElementVNode("li",{class:"sort-menu-item",onClick:v=>e.unref(G)(l.column,v)},[e.createVNode(e.unref(fe.default)),e.createTextVNode(" "+e.toDisplayString((M=e.unref(r))==null?void 0:M("table.clear")),1)],8,Ke)])]}),_:2},1032,["disabled"])]),e.createElementVNode("li",{class:"more-menu-item",onClick:n[4]||(n[4]=c=>z(!0))},[e.createVNode(e.unref(Ce.default),{class:"menu-item-icon"}),e.createTextVNode(" "+e.toDisplayString((o=e.unref(r))==null?void 0:o("table.retract")),1)]),e.unref(U)?(e.openBlock(),e.createElementBlock("li",{key:0,class:"more-menu-item",onClick:c=>ee(l.column)},[e.createVNode(e.unref(pe.default),{class:"menu-item-icon"}),e.createTextVNode(" "+e.toDisplayString((k=e.unref(r))==null?void 0:k("table.hide")),1)],8,Oe)):e.createCommentVNode("",!0),e.createElementVNode("li",{class:"more-menu-item",onClick:n[5]||(n[5]=()=>m.value=!0)},[e.createVNode(e.unref(de.default),{class:"menu-item-icon"}),e.createTextVNode(" "+e.toDisplayString((C=e.unref(r))==null?void 0:C("table.remark")),1)])])]}),_:2},1536)])):e.createCommentVNode("",!0)])],8,be))]}),key:"0"},y.value?{name:"default",fn:e.withCtx(()=>[Le]),key:"1"}:t.$slots.default&&!y.value?{name:"default",fn:e.withCtx(l=>[e.renderSlot(t.$slots,"default",e.normalizeProps(e.guardReactiveProps(l)))]),key:"2"}:void 0,e.renderList(e.unref(j)(t.$slots),(l,u)=>({name:u,fn:e.withCtx(o=>[e.renderSlot(t.$slots,u,e.normalizeProps(e.guardReactiveProps(o)))])}))]),1040,["edit-render","filters","sortable","type","field"]))}});exports.default=je;
