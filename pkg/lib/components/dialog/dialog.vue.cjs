"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),B=require("../../hooks/use_deprecated.cjs"),C=require("../../hooks/use_inherit_slot.cjs"),q=require("../../utils/utils.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");require("../../node_modules/culori/src/index.cjs");const m=require("../../utils/dom.cjs"),$=require("../../node_modules/element-plus/es/components/dialog/index.cjs"),F=require("../../node_modules/ksw-vue-icon/es/icons/base/window-min.cjs"),p=require("../../node_modules/ksw-vue-icon/es/icons/base/close.cjs"),N=require("../../node_modules/ksw-vue-icon/es/icons/base/window-max.cjs"),S=require("../../node_modules/ksw-vue-icon/es/icons/base/window-maximize.cjs"),E=require("../../node_modules/ksw-vue-icon/es/icons/base/window-reduce.cjs"),R=require("../../node_modules/element-plus/es/components/card/index.cjs"),M={key:0,class:"k-dialog__resizable-header"},T={class:"k-dialog__title"},x={class:"k-dialog__resizable-handler"},D={class:"k-dialog-minimization__content"},H={class:"k-dialog__card-title"},P=e.defineComponent({name:"KDialog",__name:"dialog",props:e.mergeModels({modelValue:{type:Boolean,default:!1},title:{default:""},fullscreen:{type:Boolean,default:!1},minHeight:{default:150},minWidth:{default:300},useResizable:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},autoFocusFirst:{type:Boolean,default:!1},autoFocusTo:{},resizable:{type:Boolean,default:!1},showResizeHandles:{type:Boolean,default:!0}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:e.mergeModels(["opened"],["update:modelValue"]),setup(g,{expose:h,emit:v}){const c=e.ref(),o=g;B.useDeprecated({scope:"k-dialog",from:"useResizable",replacement:"resizable",version:"2.0.0"},e.computed(()=>!!o.useResizable));const k=v,y=C.useInheritSlot(["header"]),u=e.useModel(g,"modelValue"),f={w:0,h:0},i=e.ref(o.fullscreen),d=e.ref(!1),r=e.computed(()=>o.resizable??o.useResizable);e.watch(()=>o.fullscreen,l=>{i.value=l}),e.watch(()=>o.modelValue,l=>{l&&(d.value=!1)});function w(){var t,s;const l=(s=(t=c.value)==null?void 0:t.dialogContentRef)==null?void 0:s.$el;if(l){if(i.value)l.style.width=`${f.w}px`,l.style.height=`${f.h}px`;else{const{width:n,height:a}=l.getBoundingClientRect();f.w=n,f.h=a,l.style.width="auto",l.style.height="100%"}d.value=!1,i.value=!i.value}}function _(){d.value=!0,u.value=!1}function z(){(o.autoFocusTo||o.autoFocusFirst)&&V(),k("opened")}function V(){var t,s,n;let l=null;if(typeof o.autoFocusTo=="string")l=m.getElement(o.autoFocusTo);else{const a=o.autoFocusTo;l=(a==null?void 0:a.$el)??a}if(l&&m.isInputElement(l)){(t=l.focus)==null||t.call(l);return}if(l=l?m.getElement("input, textarea",l):null,!l&&o.autoFocusFirst){const a=(n=(s=c.value)==null?void 0:s.dialogContentRef)==null?void 0:n.$el;l=m.getElement(".el-dialog__body input, .el-dialog__body textarea",a)}typeof(l==null?void 0:l.focus)=="function"&&l.focus()}const b={};return h(q.getExposeProxy(b,c)),(l,t)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(e.unref($.ElDialog),e.mergeProps({ref_key:"$dialog",ref:c},l.$attrs,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=s=>u.value=s),class:["k-dialog",{"k-dialog-resizable":r.value&&!i.value},{"k-dialog__is-show-handler":r.value&&l.showResizeHandles}],fullscreen:i.value,draggable:r.value||l.draggable,style:r.value?{minWidth:l.minWidth+"px",minHeight:l.minHeight+"px"}:{},onOpened:z}),e.createSlots({header:e.withCtx(()=>[r.value&&l.showResizeHandles?(e.openBlock(),e.createElementBlock("div",M,[e.createElementVNode("div",T,[e.renderSlot(l.$slots,"header",{},()=>[e.createTextVNode(e.toDisplayString(l.title),1)])]),e.createElementVNode("div",x,[e.createVNode(e.unref(F.default),{class:"mr-3",onClick:_}),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(i.value?e.unref(E.default):e.unref(N.default)),{onClick:w})),e.createVNode(e.unref(p.default),{class:"ml-3",onClick:t[0]||(t[0]=()=>u.value=!1)})])])):e.renderSlot(l.$slots,"header",{key:1},()=>[e.createTextVNode(e.toDisplayString(l.title),1)])]),_:2},[e.renderList(e.unref(y)(l.$slots),(s,n)=>({name:n,fn:e.withCtx(a=>[e.renderSlot(l.$slots,n,e.normalizeProps(e.guardReactiveProps(a)))])}))]),1040,["modelValue","class","fullscreen","draggable","style"]),d.value&&r.value?(e.openBlock(),e.createBlock(e.unref(R.ElCard),{key:0,shadow:"always",class:"k-dialog-minimization"},{default:e.withCtx(()=>[e.createElementVNode("div",D,[e.createElementVNode("div",H,[e.renderSlot(l.$slots,"header",{},()=>[e.createTextVNode(e.toDisplayString(l.title),1)])]),e.createVNode(e.unref(S.default),{size:18,class:"k-dialog__card-icon k-dialog__card-restore-icon",onClick:t[2]||(t[2]=()=>u.value=!0)}),e.createVNode(e.unref(p.default),{class:"k-dialog__card-icon",onClick:t[3]||(t[3]=()=>d.value=!1)})])]),_:3})):e.createCommentVNode("",!0)],64))}});exports.default=P;
