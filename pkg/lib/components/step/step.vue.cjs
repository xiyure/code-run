"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),x=require("../popover/index.cjs"),y=require("../../utils/utils.cjs");require("../../node_modules/resize-observer-polyfill/dist/ResizeObserver.es.cjs");require("../../node_modules/sortablejs/modular/sortable.esm.cjs");require("../../node_modules/culori/src/index.cjs");const _=require("../../node_modules/lodash-es/isNumber.cjs"),g=require("../../node_modules/element-plus/es/components/steps/index.cjs"),v=["id"],E={class:"k-step__title"},P=e.defineComponent({name:"KStep",__name:"step",props:{title:{default:""},description:{default:""},icon:{},status:{default:""},color:{},textColor:{}},setup(S,{expose:k}){const s=S,l=e.inject("stepProps",{}),d=e.inject("steps",[]),f=e.inject("stepMethods");f.registerStep(s.title);const m=y.genRandomStr(8),n={primary:"#2882FF",success:"#22C55E",error:"#EF4444",wait:"#EAE8EB"};e.watch(()=>s.title,(t,r)=>{t!==r&&f.updateStep(t,r)}),e.watch(()=>l.active,t=>{const r=d.indexOf(s.title);if(!_.default(t)||r===-1||s.status||s.color)return;t=Math.max(Math.min(t,d.length),-1);const o=Object.keys(n);let i="";if(t===r){const a=p(l.processStatus);i=o.includes(a)?n[a]:n.primary}else if(t>r){const a=p(l.finishStatus);i=o.includes(a)?n[a]:n.success}else i=n.wait;if(!i)return;const c=s.textColor||(t<r?"var(--k-theme-text--normal)":"#fff");u(i,c)},{immediate:!0}),e.watch(()=>[s.color,s.status],t=>{if(!t[0]&&!t[1])return;let r;n[s.status]?r=n[s.status]:s.color?r=s.color:r=n.primary;const o=s.textColor||(s.status==="wait"?"var(--k-theme-text--normal)":"#fff");u(r,o)},{immediate:!0}),e.watch(()=>s.textColor,t=>{u(void 0,t)});function u(t,r){typeof window<"u"&&e.nextTick(()=>{var i,c;const o=document.getElementById(m);t&&((i=o==null?void 0:o.style)==null||i.setProperty("--default-bg-color",t)),r&&((c=o==null?void 0:o.style)==null||c.setProperty("--default-color",r))})}function p(t){switch(t){case"primary":return"finish";case"wait":return"wait";case"success":return"success";case"error":return"error";default:return""}}const h=e.ref(null),C={};return k(y.getExposeProxy(C,h)),(t,r)=>e.unref(l).capsule?(e.openBlock(),e.createElementBlock("div",{key:1,id:e.unref(m),class:"k-step__capsule-box"},[e.createVNode(e.unref(x.KPopover),{"show-after":500,disabled:!s.description},{reference:e.withCtx(()=>[e.renderSlot(t.$slots,"title",{},()=>[e.createElementVNode("span",E,[s.icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(s.icon),{key:0})):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(s.title),1)])])]),default:e.withCtx(()=>[e.createTextVNode(" "+e.toDisplayString(s.description),1)]),_:3},8,["disabled"])],8,v)):(e.openBlock(),e.createBlock(e.unref(g.ElStep),e.mergeProps({key:0,ref_key:"KStepRef",ref:h,class:"k-step"},t.$attrs,{title:t.title,description:t.description,icon:t.icon,status:p(t.status)}),e.createSlots({_:2},[e.renderList(t.$slots,(o,i)=>({name:i,fn:e.withCtx(c=>[e.renderSlot(t.$slots,i,e.normalizeProps(e.guardReactiveProps(c)))])}))]),1040,["title","description","icon","status"]))}});exports.default=P;
